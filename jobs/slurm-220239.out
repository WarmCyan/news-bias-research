2019-11-05 13:14:22,847 - experiment.py - INFO - =====================================================
2019-11-05 13:14:22,847 - experiment.py - INFO - Experiment ../experiments/cnn_reliability_0.json 10 started...
2019-11-05 13:14:22,847 - experiment.py - INFO - =====================================================
2019-11-05 13:14:22,848 - util.py - INFO - CALL::__main__.experiment_model(selection_problem = 'biased', selection_source = 'mbfc', selection_count = 15000, selection_random_seed = 13, selection_reject_minimum = 500, selection_overwrite = False, embedding_type = 'w2v', embedding_shape = 'sequence', embedding_overwrite = False, test_source = 'as', model_type = 'cnn', model_arch_num = 1, model_layer_sizes = [[32, 300, 300], 1], model_maxlen = 500, model_batch_size = 128, model_learning_rate = 0.001, model_epochs = 100, model_num = 10, verbose = False, params = {'type': 'model', 'selection_problem': 'biased', 'selection_source': 'mbfc', 'selection_count': 15000, 'selection_random_seed': 13, 'selection_reject_minimum': 500, 'selection_overwrite': False, 'embedding_type': 'w2v', 'embedding_shape': 'sequence', 'embedding_overwrite': False, 'verbose': False, 'test_source': 'as', 'model_type': 'cnn', 'model_arch_num': 1, 'model_layer_sizes': [[32, 300, 300], 1], 'model_maxlen': 500, 'model_batch_size': 128, 'model_learning_rate': 0.001, 'model_epochs': 100, 'model_num': 10})
2019-11-05 13:14:22,848 - util.py - INFO - CALL::datasets.get_selection_set(problem = 'biased', source = 'mbfc', count = 15000, random_seed = 13, reject_minimum = 500, overwrite = False, verbose = False)
2019-11-05 13:14:22,858 - util.py - INFO - CALL::datasets.create_selection_set_sources(target_count = 15000, reject_minimum = 500, overwrite = False, verbose = False)
2019-11-05 13:14:22,858 - util.py - INFO - Cached version found.
2019-11-05 13:14:22,859 - datasets.py - INFO - Creating binary selection selection_biased_mbfc_13...
2019-11-05 13:14:22,860 - util.py - INFO - Cached version found.
2019-11-05 13:14:22,860 - datasets.py - INFO - Loading ../data/cache/selection_biased_mbfc_13...
Empty DataFrame
Columns: [date, source, name, content, biased]
Index: []
2019-11-05 13:14:22,899 - util.py - INFO - CALL::datasets.get_embedding_set(df =             date  ... biased
0     2018-10-19  ...      1
1     2018-11-02  ...      1
2     2018-07-26  ...      1
3     2018-09-06  ...      1
4     2018-07-29  ...      1
...          ...  ...    ...
3763  2018-09-20  ...      0
3764  2018-10-18  ...      0
3765  2018-03-19  ...      0
3766  2018-02-22  ...      0
3767  2018-02-27  ...      0

[3768 rows x 5 columns], embedding_type = 'w2v', output_name = 'selection_biased_mbfc_13', shaping = 'sequence', overwrite = False)
2019-11-05 13:14:22,899 - datasets.py - INFO - Creating w2v embedding selection_biased_mbfc_13...
2019-11-05 13:14:22,900 - util.py - INFO - Cached version found.
2019-11-05 13:14:25,459 - util.py - INFO - CALL::datasets.get_test_embedding_set(problem = 'biased', source = 'mbfc', source_test = 'as', count = 15000, reject_minimum = 500, random_seed = 13, embedding_type = 'w2v', shaping = 'sequence')
2019-11-05 13:14:25,460 - util.py - INFO - CALL::datasets.create_selection_set_sources(target_count = 15000, reject_minimum = 500, overwrite = False, verbose = False)
2019-11-05 13:14:25,460 - util.py - INFO - Cached version found.
2019-11-05 13:14:25,461 - util.py - INFO - CALL::datasets.get_selection_set(problem = 'biased', source = 'as', count = 15000, random_seed = 13, reject_minimum = 500, overwrite = False, verbose = False)
2019-11-05 13:14:25,469 - util.py - INFO - CALL::datasets.create_selection_set_sources(target_count = 15000, reject_minimum = 500, overwrite = False, verbose = False)
2019-11-05 13:14:25,469 - util.py - INFO - Cached version found.
2019-11-05 13:14:25,470 - datasets.py - INFO - Creating binary selection selection_biased_as_13...
2019-11-05 13:14:25,470 - util.py - INFO - Cached version found.
2019-11-05 13:14:25,470 - datasets.py - INFO - Loading ../data/cache/selection_biased_as_13...
Empty DataFrame
Columns: [date, source, name, content, biased]
Index: []
2019-11-05 13:14:25,509 - util.py - INFO - CALL::datasets.get_embedding_set(df =             date  ... biased
0     2018-10-19  ...      1
1     2018-11-02  ...      1
2     2018-07-26  ...      1
3     2018-09-06  ...      1
4     2018-07-29  ...      1
...          ...  ...    ...
7853  2018-09-26  ...      0
7854  2018-11-08  ...      0
7855  2018-02-22  ...      0
7856  2018-08-15  ...      0
7857  2018-03-18  ...      0

[7858 rows x 5 columns], embedding_type = 'w2v', output_name = 'selection_biased_as_13', shaping = 'sequence', overwrite = False)
2019-11-05 13:14:25,509 - datasets.py - INFO - Creating w2v embedding selection_biased_as_13...
2019-11-05 13:14:25,509 - util.py - INFO - Cached version found.
2019-11-05 13:14:30,556 - util.py - INFO - CALL::cnn.train_test(X = array([[[ 0.14550781],
        [-0.0189209 ],
        [ 0.09619141],
        ...,
        [ 0.21582031],
        [-0.13378906],
        [-0.06494141]],

       [[ 0.08447266],
        [-0.00035286],
        [ 0.05322266],
        ...,
        [ 0.05444336],
        [ 0.140625  ],
        [ 0.30664062]],

       [[-0.01623535],
        [ 0.09423828],
        [ 0.09179688],
        ...,
        [-0.08300781],
        [ 0.06542969],
        [-0.02941895]],

       ...,

       [[ 0.328125  ],
        [ 0.04492188],
        [ 0.08886719],
        ...,
        [ 0.        ],
        [ 0.        ],
        [ 0.        ]],

       [[ 0.328125  ],
        [ 0.04492188],
        [ 0.08886719],
        ...,
        [ 0.        ],
        [ 0.        ],
        [ 0.        ]],

       [[-0.02636719],
        [ 0.06835938],
        [-0.03112793],
        ...,
        [ 0.18261719],
        [ 0.08544922],
        [-0.15429688]]], dtype=float32), y = 0       1
1       1
2       1
3       1
4       1
       ..
3763    0
3764    0
3765    0
3766    0
3767    0
Name: biased, Length: 3768, dtype: int64, arch_num = 1, layer_sizes = [[32, 300, 300], 1], maxlen = 500, batch_size = 128, learning_rate = 0.001, epochs = 100, X_test = array([[[-0.04321289],
        [-0.01080322],
        [ 0.21582031],
        ...,
        [ 0.        ],
        [ 0.        ],
        [ 0.        ]],

       [[-0.09033203],
        [ 0.28125   ],
        [ 0.17675781],
        ...,
        [ 0.        ],
        [ 0.        ],
        [ 0.        ]],

       [[ 0.06738281],
        [-0.12451172],
        [ 0.1796875 ],
        ...,
        [ 0.04125977],
        [-0.04882812],
        [-0.02050781]],

       ...,

       [[ 0.03222656],
        [ 0.12207031],
        [ 0.22558594],
        ...,
        [ 0.        ],
        [ 0.        ],
        [ 0.        ]],

       [[ 0.01660156],
        [ 0.0456543 ],
        [-0.11914062],
        ...,
        [-0.00744629],
        [-0.07568359],
        [ 0.08789062]],

       [[-0.02490234],
        [ 0.02197266],
        [-0.03540039],
        ...,
        [ 0.04199219],
        [ 0.16308594],
        [ 0.02026367]]], dtype=float32), y_test = 1194    1
1371    1
557     1
2887    1
1176    1
       ..
583     1
2156    1
246     1
864     1
1198    1
Name: biased, Length: 686, dtype: int64, name = 'selection_biased_mbfc_13_cnn_1_10_500_128_0.001')
Using TensorFlow backend.
WARNING:tensorflow:From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2019-11-05 13:14:30,557 - deprecation_wrapper.py - WARNING - From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2019-11-05 13:14:30,573 - deprecation_wrapper.py - WARNING - From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

2019-11-05 13:14:30,575 - deprecation_wrapper.py - WARNING - From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

2019-11-05 13:14:30,621 - deprecation_wrapper.py - WARNING - From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3376: The name tf.log is deprecated. Please use tf.math.log instead.

2019-11-05 13:14:30,625 - deprecation_wrapper.py - WARNING - From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3376: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/tensorflow/python/ops/nn_impl.py:180: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2019-11-05 13:14:30,628 - deprecation.py - WARNING - From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/tensorflow/python/ops/nn_impl.py:180: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:986: The name tf.assign_add is deprecated. Please use tf.compat.v1.assign_add instead.

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv1d_1 (Conv1D)            (None, 500, 32)           9632      
_________________________________________________________________
flatten_1 (Flatten)          (None, 16000)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 16001     
=================================================================
Total params: 25,633
Trainable params: 25,633
Non-trainable params: 0
_________________________________________________________________
2019-11-05 13:14:31,802 - deprecation_wrapper.py - WARNING - From /home/tntech.edu/namartinda42/.conda/envs/tensorflow-gpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:986: The name tf.assign_add is deprecated. Please use tf.compat.v1.assign_add instead.

2019-11-05 13:14:32.029005: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-11-05 13:14:32.035640: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2394370000 Hz
2019-11-05 13:14:32.035780: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5555dd9eada0 executing computations on platform Host. Devices:
2019-11-05 13:14:32.035801: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2019-11-05 13:14:32.037328: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Could not dlopen library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /cm/shared/apps/cuda91/toolkit/9.1.85/extras/CUPTI/lib64:/cm/local/apps/cuda/libs/current/lib64:/cm/shared/apps/cuda91/toolkit/9.1.85/targets/x86_64-linux/lib:/cm/local/apps/gcc/6.3.0/lib:/cm/local/apps/gcc/6.3.0/lib64:/cm/shared/apps/openmpi/gcc/64/1.10.3/lib64:/cm/shared/apps/slurm/17.02.10/lib64/slurm:/cm/shared/apps/slurm/17.02.10/lib64
2019-11-05 13:14:32.037350: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: UNKNOWN ERROR (303)
2019-11-05 13:14:32.037370: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (node037): /proc/driver/nvidia/version does not exist
2019-11-05 13:14:32.131108: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
Train on 3014 samples, validate on 754 samples
Epoch 1/100
 - 6s - loss: 0.6232 - binary_accuracy: 0.6433 - val_loss: 0.5198 - val_binary_accuracy: 0.7281
Epoch 2/100
 - 6s - loss: 0.4599 - binary_accuracy: 0.7863 - val_loss: 0.4601 - val_binary_accuracy: 0.7706
Epoch 3/100
 - 6s - loss: 0.3791 - binary_accuracy: 0.8421 - val_loss: 0.4183 - val_binary_accuracy: 0.8103
Epoch 4/100
 - 6s - loss: 0.2960 - binary_accuracy: 0.8942 - val_loss: 0.3949 - val_binary_accuracy: 0.8263
Epoch 5/100
 - 6s - loss: 0.2391 - binary_accuracy: 0.9157 - val_loss: 0.3858 - val_binary_accuracy: 0.8130
Epoch 6/100
 - 6s - loss: 0.1877 - binary_accuracy: 0.9472 - val_loss: 0.3930 - val_binary_accuracy: 0.8236
Epoch 7/100
 - 6s - loss: 0.1511 - binary_accuracy: 0.9618 - val_loss: 0.3769 - val_binary_accuracy: 0.8223
Epoch 8/100
 - 6s - loss: 0.1157 - binary_accuracy: 0.9794 - val_loss: 0.3888 - val_binary_accuracy: 0.8170
Epoch 9/100
 - 6s - loss: 0.0918 - binary_accuracy: 0.9834 - val_loss: 0.3935 - val_binary_accuracy: 0.8263
Epoch 10/100
 - 6s - loss: 0.0723 - binary_accuracy: 0.9897 - val_loss: 0.4010 - val_binary_accuracy: 0.8289

128/686 [====>.........................] - ETA: 0s
384/686 [===============>..............] - ETA: 0s
640/686 [==========================>...] - ETA: 0s
686/686 [==============================] - 0s 377us/step
2019-11-05 13:15:29,702 - cnn.py - INFO - Test loss / test accuracy: 0.472583 / 0.820700
